var nAgt=navigator.userAgent;if(!jQuery.browser){jQuery.browser={},jQuery.browser.mozilla=!1,jQuery.browser.webkit=!1,jQuery.browser.opera=!1,jQuery.browser.safari=!1,jQuery.browser.chrome=!1,jQuery.browser.msie=!1,jQuery.browser.ua=nAgt,jQuery.browser.name=navigator.appName,jQuery.browser.fullVersion=""+parseFloat(navigator.appVersion),jQuery.browser.majorVersion=parseInt(navigator.appVersion,10);var nameOffset,verOffset,ix;if(-1!=(verOffset=nAgt.indexOf("Opera")))jQuery.browser.opera=!0,jQuery.browser.name="Opera",jQuery.browser.fullVersion=nAgt.substring(verOffset+6),-1!=(verOffset=nAgt.indexOf("Version"))&&(jQuery.browser.fullVersion=nAgt.substring(verOffset+8));else if(-1!=(verOffset=nAgt.indexOf("OPR")))jQuery.browser.opera=!0,jQuery.browser.name="Opera",jQuery.browser.fullVersion=nAgt.substring(verOffset+4);else if(-1!=(verOffset=nAgt.indexOf("MSIE")))jQuery.browser.msie=!0,jQuery.browser.name="Microsoft Internet Explorer",jQuery.browser.fullVersion=nAgt.substring(verOffset+5);else if(-1!=nAgt.indexOf("Trident")){jQuery.browser.msie=!0,jQuery.browser.name="Microsoft Internet Explorer";var start=nAgt.indexOf("rv:")+3,end=start+4;jQuery.browser.fullVersion=nAgt.substring(start,end)}else-1!=(verOffset=nAgt.indexOf("Chrome"))?(jQuery.browser.webkit=!0,jQuery.browser.chrome=!0,jQuery.browser.name="Chrome",jQuery.browser.fullVersion=nAgt.substring(verOffset+7)):-1!=(verOffset=nAgt.indexOf("Safari"))?(jQuery.browser.webkit=!0,jQuery.browser.safari=!0,jQuery.browser.name="Safari",jQuery.browser.fullVersion=nAgt.substring(verOffset+7),-1!=(verOffset=nAgt.indexOf("Version"))&&(jQuery.browser.fullVersion=nAgt.substring(verOffset+8))):-1!=(verOffset=nAgt.indexOf("AppleWebkit"))?(jQuery.browser.webkit=!0,jQuery.browser.name="Safari",jQuery.browser.fullVersion=nAgt.substring(verOffset+7),-1!=(verOffset=nAgt.indexOf("Version"))&&(jQuery.browser.fullVersion=nAgt.substring(verOffset+8))):-1!=(verOffset=nAgt.indexOf("Firefox"))?(jQuery.browser.mozilla=!0,jQuery.browser.name="Firefox",jQuery.browser.fullVersion=nAgt.substring(verOffset+8)):(nameOffset=nAgt.lastIndexOf(" ")+1)<(verOffset=nAgt.lastIndexOf("/"))&&(jQuery.browser.name=nAgt.substring(nameOffset,verOffset),jQuery.browser.fullVersion=nAgt.substring(verOffset+1),jQuery.browser.name.toLowerCase()==jQuery.browser.name.toUpperCase()&&(jQuery.browser.name=navigator.appName));-1!=(ix=jQuery.browser.fullVersion.indexOf(";"))&&(jQuery.browser.fullVersion=jQuery.browser.fullVersion.substring(0,ix)),-1!=(ix=jQuery.browser.fullVersion.indexOf(" "))&&(jQuery.browser.fullVersion=jQuery.browser.fullVersion.substring(0,ix)),jQuery.browser.majorVersion=parseInt(""+jQuery.browser.fullVersion,10),isNaN(jQuery.browser.majorVersion)&&(jQuery.browser.fullVersion=""+parseFloat(navigator.appVersion),jQuery.browser.majorVersion=parseInt(navigator.appVersion,10)),jQuery.browser.version=jQuery.browser.majorVersion}jQuery.browser.android=/Android/i.test(nAgt),jQuery.browser.blackberry=/BlackBerry/i.test(nAgt),jQuery.browser.ios=/iPhone|iPad|iPod/i.test(nAgt),jQuery.browser.operaMobile=/Opera Mini/i.test(nAgt),jQuery.browser.windowsMobile=/IEMobile/i.test(nAgt),jQuery.browser.mobile=jQuery.browser.android||jQuery.browser.blackberry||jQuery.browser.ios||jQuery.browser.windowsMobile||jQuery.browser.operaMobile,function(c){c.extend({metadata:{defaults:{type:"class",name:"metadata",cre:/({.*})/,single:"metadata"},setType:function(e,t){this.defaults.type=e,this.defaults.name=t},get:function(b,f){var d=c.extend({},this.defaults,f);d.single.length||(d.single="metadata");var a=c.data(b,d.single);if(a)return a;if(a="{}","class"==d.type){var e=d.cre.exec(b.className);e&&(a=e[1])}else if("elem"==d.type){if(!b.getElementsByTagName)return;e=b.getElementsByTagName(d.name),e.length&&(a=c.trim(e[0].innerHTML))}else void 0!=b.getAttribute&&(e=b.getAttribute(d.name))&&(a=e);return 0>a.indexOf("{")&&(a="{"+a+"}"),a=eval("("+a+")"),c.data(b,d.single,a),a}}}),c.fn.metadata=function(e){return c.metadata.get(this[0],e)}}(jQuery),function(e){document.extruder=new Object,document.extruder.left=0,document.extruder.top=0,document.extruder.bottom=0,document.extruder.right=0,document.extruder.idx=0;var t=e.browser.msie;e.mbExtruder={author:"Matteo Bicocchi",version:"2.5.5",defaults:{width:350,positionFixed:!0,sensibility:800,position:"top",accordionPanels:!0,top:"auto",extruderOpacity:1,flapMargin:35,textOrientation:"bt",onExtOpen:function(){},onExtContentLoad:function(){},onExtClose:function(){},hidePanelsOnClose:!0,closeOnClick:!0,closeOnExternalClick:!0,autoCloseTime:0,autoOpenTime:0,slideTimer:300},buildMbExtruder:function(r){return this.each(function(){this.options={},e.extend(this.options,e.mbExtruder.defaults),e.extend(this.options,r),this.idx=document.extruder.idx,document.extruder.idx++;var s,o,i,n,a,d,l,u;s=e(this),o=s.html(),s.css("zIndex",100);var c="left"==this.options.position||"right"==this.options.position,f=c?1:this.options.width,p=e(window).height(),b=e("<div/>").addClass("extruder-content").css({overflow:"auto",width:f,height:p});b.append(o),s.html(b);var h=this.options.positionFixed?"fixed":"absolute";s.addClass("extruder"),s.addClass(this.options.position);var x="top"==this.options.position||"bottom"==this.options.position,m=0;if(s.metadata().top&&(m=s.metadata().top),n="top"==this.options.position?{position:h,top:m,left:"50%",marginLeft:-this.options.width/2,width:this.options.width}:"bottom"==this.options.position?{position:h,bottom:0,left:"50%",marginLeft:-this.options.width/2,width:this.options.width}:"left"==this.options.position?{position:h,top:m,left:0,width:1}:{position:h,top:m,right:0,width:1},s.css(n),t||s.css({opacity:this.options.extruderOpacity}),"left"==this.options.position&&s.css({"border-right":"4px solid #eb1b22"}),"right"==this.options.position&&s.css({"border-left":"4px solid #eb1b22"}),s.wrapInner("<div class='ext_wrapper'></div>"),i=s.find(".ext_wrapper"),a={position:"absolute",width:c?1:this.options.width},i.css(a),x&&("top"==this.options.position?document.extruder.top++:document.extruder.bottom++,document.extruder.top>1||document.extruder.bottom>1))return void alert("more than 1 mb.extruder on top or bottom is not supported jet... hope soon!");e.metadata&&(e.metadata.setType("class"),s.metadata().title&&s.attr("extTitle",s.metadata().title),s.metadata().url&&s.attr("extUrl",s.metadata().url),s.metadata().data&&s.attr("extData",s.metadata().data));var w=e("<div class='footer'/>"),v=e("<div class='flap'><span class='flapLabel'/></div>");document.extruder.bottom?(i.prepend(w),i.prepend(v)):(i.append(w),i.append(v)),d=s.attr("extTitle")?s.attr("extTitle"):"";var g=s.find(".flapLabel");if(g.text(d),c){g.html(d).css({whiteSpace:"noWrap"});var y=("tb"==this.options.textOrientation,s.find(".flapLabel").getFlipTextDim()[1])}else g.html(d).css({whiteSpace:"noWrap"});if(s.attr("extUrl"))s.setMbExtruderContent({url:s.attr("extUrl"),data:s.attr("extData"),callback:function(){s.get(0).options.onExtContentLoad&&s.get(0).options.onExtContentLoad()}});else{var j=e("<div>").addClass("text").css({width:s.get(0).options.width-20,overflowY:"auto"});b.wrapInner(j),s.setExtruderVoicesAction()}if(v.on("click",function(){s.attr("isOpened")?(s.closeMbExtruder(),s.removeAttr("isOpened")):s.openMbExtruder()}).on("mouseenter",function(){s.get(0).options.autoOpenTime>0&&(u=setTimeout(function(){s.openMbExtruder(),e(document).one("click.extruder"+s.get(0).idx,function(){s.closeMbExtruder()})},s.get(0).options.autoOpenTime))}).on("mouseleave",function(){clearTimeout(u)}),b.on("mouseleave",function(t){s.get(0).options.closeOnExternalClick&&(e(t.target).parents().is(".text")||e(document).one("click.extruder"+s.get(0).idx,function(){s.closeMbExtruder()})),l=setTimeout(function(){s.get(0).options.autoCloseTime>0&&s.closeMbExtruder()},s.get(0).options.autoCloseTime)}).on("mouseenter",function(){clearTimeout(l),e(document).off("click.extruder"+s.get(0).idx)}),c){b.css({height:"100%"}),"auto"==this.options.top?(v.css({top:100+("left"==this.options.position?document.extruder.left:document.extruder.right)}),"left"==this.options.position?document.extruder.left+=y+this.options.flapMargin:document.extruder.right+=y+this.options.flapMargin):v.css({top:this.options.top});var O=e("<div/>").css({position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"transparent"});v.append(O)}this.originalWidth=this.options.width,e(window).on("resize",function(){s.adjustSize()})})},adjustSize:function(){var t=this,r=t.get(0),s="top"==r.options.position||"bottom"==r.options.position;s?e(window).width()<r.options.width?(t.css({width:e(window).width(),marginLeft:0,left:0}),t.find(".ext_wrapper, .extruder-content, .extruder-container").css({width:"100%"})):(t.css({width:r.options.width,left:"50%",marginLeft:-r.options.width/2}),t.find(".ext_wrapper, .extruder-content, .extruder-container").css({width:"100%"})):(r.options.width=r.originalWidth,t.attr("isOpened")&&(t.find(".extruder-content").css({width:r.options.width}),t.find(".ext_wrapper, .extruder-content, .extruder-container").css({width:r.options.width})))},setMbExtruderContent:function(t){if(this.options={url:!1,data:"",callback:function(){}},e.extend(this.options,t),!this.options.url||0==this.options.url.length)return void alert("internal error: no URL to call");var r,s=this.options.url,o=this.options.data,i=e(this),n=this.options.callback,a=e("<div>").addClass("extruder-container");e.browser.msie&&e.browser.version<=7||a.css({width:e(this).get(0).options.width}),i.find(".extruder-content").wrapInner(a),e.ajax({type:"GET",url:s,data:o,async:!0,dataType:"html",success:function(t){i.find(".extruder-container").append(t),r=i.find(".voice"),r.hover(function(){e(this).addClass("hover")},function(){e(this).removeClass("hover")}),i.setExtruderVoicesAction(),n&&setTimeout(function(){n()},100)}})},openMbExtruder:function(r){e(".block-content").hide(),e(".block-footer").hide(),e(".extruder-container .block-content").show(),e(".extruder-container .block-footer").show(),e("#header").removeClass("nav-up");var s=e(this);s.adjustSize(),s.attr("isOpened",!0),e(document).off("click.extruder"+s.get(0).idx);var o=s.get(0).options;s.addClass("isOpened"),t||s.css("opacity",1);var i=o.position;if(s.mb_bringToFront(),"top"==i||"bottom"==i?(s.find(".extruder-content").slideDown(o.slideTimer),o.onExtOpen&&o.onExtOpen()):(t||e(this).css("opacity",1),s.find(".ext_wrapper").css({width:""}),s.find(".extruder-content").css({overflowX:"auto",display:"block"}),s.find(".extruder-content").animate({width:o.width},o.slideTimer,function(){s.find(".extruder-container").css({width:o.width})}),o.onExtOpen&&o.onExtOpen()),s.find(".flap").addClass("active"),s.find(".flap").css("top","65px"),s.metadata().title_back){var n=s.find(".flapLabel");n.text(s.metadata().title_back)}r&&setTimeout(function(){e(document).one("click.extruder"+s.get(0).idx,function(){s.closeMbExtruder()})},100)},closeMbExtruder:function(){var r=e(this);r.removeAttr("isOpened");var s=r.get(0).options;if(r.removeClass("isOpened"),e(document).off("click.extruder"+r.get(0).idx),t||r.css("opacity",s.extruderOpacity),s.hidePanelsOnClose&&r.hidePanelsOnClose(),"top"==s.position||"bottom"==s.position?(r.find(".extruder-content").slideUp(s.slideTimer),s.onExtClose&&s.onExtClose()):("left"==s.position||"right"==s.position)&&(r.find(".extruder-content").css({overflow:"auto"}),r.find(".extruder-content").animate({width:1},s.slideTimer,function(){r.find(".ext_wrapper").css({width:1}),r.find(".extruder-content").css({overflow:"auto",display:"none"}),s.onExtClose&&s.onExtClose()})),r.find(".flap").removeClass("active"),r.find(".flap").css("top","100px"),r.metadata().title_back){var o=r.find(".flapLabel");o.text(r.metadata().title)}e(".block-content").show(),e(".block-footer").show()}},jQuery.fn.mb_bringToFront=function(){var t=10;return e("*").each(function(){if("absolute"==e(this).css("position")||"fixed"==e(this).css("position")){var r=parseInt(e(this).css("zIndex"));t=r>t?parseInt(e(this).css("zIndex")):t}}),e(this).css("zIndex",t+=1),t},e.fn.setExtruderVoicesAction=function(){var t=e(this),r=t.get(0).options,s=e(this).find(".voice");s.each(function(){var o=e(this);e.metadata&&(e.metadata.setType("class"),o.metadata().panel&&o.attr("panel",o.metadata().panel),o.metadata().data&&o.attr("data",o.metadata().data),o.metadata().disabled&&o.attr("setDisabled",o.metadata().disabled)),o.attr("setDisabled")&&o.disableExtruderVoice(),o.attr("panel")&&"false"!=o.attr("panel")&&(o.append("<span class='settingsBtn'/>"),o.find(".settingsBtn").css({opacity:.5}),o.find(".settingsBtn").hover(function(){e(this).css({opacity:1})},function(){e(this).not(".sel").css({opacity:.5})}).click(function(){if(e(this).parents().hasClass("sel"))return void(r.accordionPanels?t.hidePanelsOnClose():e(this).closePanel());r.accordionPanels&&(t.find(".optionsPanel").slideUp(400,function(){e(this).remove()}),s.removeClass("sel"),s.find(".settingsBtn").removeClass("sel").css({opacity:.5}));var i=e("<div class='optionsPanel'></div>");o.after(i),e.ajax({type:"GET",url:o.attr("panel"),data:o.attr("data"),async:!0,dataType:"html",success:function(s){var o=e(s);i.html(o),i.children().not(".text").addClass("panelVoice").click(function(){r.closeOnClick&&t.closeMbExtruder()}),i.slideDown(400)}}),o.addClass("sel"),o.find(".settingsBtn").addClass("sel").css({opacity:1})})),0==o.find("a").length&&o.attr("panel")&&o.find(".label").not(".disabled").css("cursor","pointer").click(function(){o.find(".settingsBtn").click()}),o.attr("panel")&&"false"!=o.attr("panel")||o.attr("setDisabled")&&"true"==o.attr("setDisabled")||o.find(".label").click(function(){t.hidePanelsOnClose(),r.closeOnClick&&t.closeMbExtruder()})})},e.fn.disableExtruderVoice=function(){var t=e(this),r=t.find(".label");t.removeClass("sel"),t.next(".optionsPanel").slideUp(400,function(){e(this).remove()}),t.attr("setDisabled",!0),r.css("opacity",.4),t.hover(function(){e(this).removeClass("hover")},function(){e(this).removeClass("hover")}),r.addClass("disabled").css("cursor","default"),t.find(".settingsBtn").hide(),t.on("click",function(e){return e.stopPropagation(),!1})},e.fn.enableExtruderVoice=function(){var t=e(this);t.attr("setDisabled",!1),t.find(".label").css("opacity",1),t.find(".label").removeClass("disabled").css("cursor","pointer"),t.off("click"),t.find(".settingsBtn").show()},e.fn.hidePanelsOnClose=function(){var t=e(this).find(".voice");e(this).find(".optionsPanel").slideUp(400,function(){e(this).remove()}),t.removeClass("sel"),t.find(".settingsBtn").removeClass("sel").css("opacity",.5)},e.fn.openPanel=function(){var t=e(this).hasClass("voice")?e(this):e(this).find(".voice");t.each(function(){e(this).hasClass("sel")||e(this).find(".settingsBtn").click()})},e.fn.closePanel=function(){var t=e(this).hasClass("voice")?e(this):e(this).parent(".voice");t.next(".optionsPanel").slideUp(400,function(){e(this).remove()}),t.removeClass("sel"),e(this).removeClass("sel").css("opacity",.5)},e.fn.buildMbExtruder=e.mbExtruder.buildMbExtruder,e.fn.setMbExtruderContent=e.mbExtruder.setMbExtruderContent,e.fn.closeMbExtruder=e.mbExtruder.closeMbExtruder,e.fn.openMbExtruder=e.mbExtruder.openMbExtruder,e.fn.adjustSize=e.mbExtruder.adjustSize}(jQuery);